<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SRPG Engine</title>
    <style>
        body {
            background: #202020; margin: 0; display: flex;
            justify-content: center; align-items: center; height: 100vh;
            color: white; font-family: 'Segoe UI', sans-serif; overflow: hidden;
        }
        
        .game-wrapper {
            position: relative;
            width: 100%; max-width: 640px;
            aspect-ratio: 4 / 3;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
        }

        canvas { 
            background: #000; display: block; width: 100%; height: 100%; cursor: crosshair; 
        }

        #turn-indicator {
            position: absolute; top: 10px; left: 10px;
            background: rgba(0, 0, 0, 0.5); padding: 5px 10px;
            border-radius: 5px; font-size: 14px; font-weight: bold; color: white;
            pointer-events: none; z-index: 15; border: 1px solid #777;
        }

        /* [신규] 줌 컨트롤 버튼 */
        #zoom-controls {
            position: absolute; top: 10px; right: 10px;
            display: flex; gap: 5px; z-index: 15;
        }
        .zoom-btn {
            width: 30px; height: 30px;
            background: rgba(0, 0, 0, 0.6); border: 1px solid #777;
            color: white; font-size: 18px; font-weight: bold;
            cursor: pointer; border-radius: 4px; display: flex;
            justify-content: center; align-items: center;
            user-select: none;
        }
        .zoom-btn:active { background: rgba(255, 255, 255, 0.2); }

        #game-ui {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 20%;
            background: rgba(0, 0, 0, 0.9); border-top: 1px solid #555;
            box-sizing: border-box; display: flex; padding: 5px 10px;
            justify-content: space-between; align-items: center;
            pointer-events: none; z-index: 10;
        }

        .unit-info { display: flex; flex-direction: column; gap: 2px; width: 35%; }
        .unit-name { font-size: 14px; font-weight: bold; color: #ffcc00; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .unit-class { font-size: 10px; color: #aaa; }
        .hp-bar-bg { width: 100%; height: 6px; background: #333; border: 1px solid #555; border-radius: 2px; margin-bottom: 2px;}
        .hp-bar-fill { width: 100%; height: 100%; background: #00ff00; transition: width 0.2s; }
        .mp-bar-bg { width: 100%; height: 4px; background: #222; border: 1px solid #444; border-radius: 2px; }
        .mp-bar-fill { width: 100%; height: 100%; background: #0088ff; transition: width 0.2s; }
        .status-text { font-size: 9px; text-align: right; color: #ddd; display: none; }

        .stats-info { display: flex; gap: 8px; font-size: 12px; font-weight: bold; width: 35%; justify-content: center; }
        .stat-box { text-align: center; }
        .stat-box span { display: block; font-size: 9px; color: #aaa; font-weight: normal; }

        .terrain-info { text-align: right; width: 25%; }
        .terrain-name { font-size: 12px; font-weight: bold; color: #88ccff; }

        @media (max-width: 500px) {
            .stats-info { display: none; }
            .unit-info { width: 60%; }
            .terrain-info { width: 35%; }
            #turn-indicator { font-size: 12px; padding: 3px 6px; }
        }

        #action-menu, #skill-menu {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(40, 40, 40, 0.95);
            border: 2px solid #ffcc00; border-radius: 8px;
            padding: 10px; display: none; flex-direction: column; gap: 8px;
            z-index: 20; min-width: 140px;
        }
        .menu-btn {
            background: #555; color: white; border: 1px solid #777;
            padding: 10px; cursor: pointer; text-align: center; font-size: 14px;
        }
        .menu-title { text-align: center; font-size: 12px; color: #ffcc00; margin-bottom: 5px; }

    </style>
</head>
<body>
    <div class="game-wrapper">
        <canvas id="gameCanvas" width="640" height="480"></canvas>
        
        <div id="turn-indicator">TURN: PLAYER</div>

        <div id="zoom-controls">
            <div class="zoom-btn" id="btn-zoom-in">+</div>
            <div class="zoom-btn" id="btn-zoom-out">-</div>
        </div>

        <div id="action-menu">
            <div class="menu-title">행동 선택</div>
            <button class="menu-btn" id="btn-attack">공격</button>
            <button class="menu-btn" id="btn-magic">책략</button>
            <button class="menu-btn" id="btn-wait">대기</button>
        </div>

        <div id="skill-menu">
            <div class="menu-title">책략 선택</div>
            <button class="menu-btn" onclick="cancelSkill()">취소</button>
        </div>

        <div id="game-ui">
            <div class="unit-info" id="ui-unit-panel" style="opacity: 0;">
                <div class="unit-name" id="ui-name">-</div>
                <div class="unit-class" id="ui-class">-</div>
                <div class="hp-bar-bg"><div class="hp-bar-fill" id="ui-hp-bar"></div></div>
                <div class="mp-bar-bg"><div class="mp-bar-fill" id="ui-mp-bar"></div></div>
                <div class="status-text" id="ui-hp-text"></div>
                <div class="status-text" id="ui-mp-text"></div>
            </div>

            <div class="stats-info" id="ui-stats-panel" style="opacity: 0;">
                <div class="stat-box"><span>공격</span><div id="ui-atk">0</div></div>
                <div class="stat-box"><span>정신</span><div id="ui-int">0</div></div>
                <div class="stat-box"><span>방어</span><div id="ui-def">0</div></div>
            </div>

            <div class="terrain-info">
                <div class="terrain-name" id="ui-terrain">-</div>
                <div id="ui-terrain-effect" style="font-size:10px; color:#aaa;">-</div>
            </div>
        </div>
    </div>
    
    <script type="module">
        import { GameManager } from './js/core/GameManager.js';
        const game = new GameManager();
        game.init();
        window.cancelSkill = () => game.openActionMenu(); 
    </script>
</body>
</html>